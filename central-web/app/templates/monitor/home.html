{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block styles %}
{{super()}}
<link rel="stylesheet" href="{{url_for('static', filename='monitor/home.css')}}">
{% endblock %}

{% block scripts %}
{{super()}}
<script>
$(document).ready(function(){
    $('[data-toggle="popover"]').popover({'container': 'body', 'trigger': 'click', 'placement': 'right'});
});
</script>
{% endblock %}

{% block page_content %}
	<div class="monitor">
		<div class="panel panel-primary">
			<div class="panel-heading">
				<h3 class="form-heading">Current Configuration Status</h3>
			</div>
			<div class="panel-body">
			{% if configuration %}
				<h3>Current configuration '{{configuration.name}}'&nbsp;-&nbsp;
				{% if configuration.active %}
					Alarm Active
					{% if current_user.is_alarm_setter() %}
					<a	class="btn btn-primary" role="button" 
						href="{{ url_for('monitor.deactivate_config') }}"
						onclick="return window.confirm('Are you sure you want to deactivate the alarm system?');">
						Deactivate
					</a>
					{% endif %}
				</h3>
				{# TODO How to implement "realtime" update of devices tooltips? #}
				<div class="monitor-map-area">
					{{ svgMap|safe }}
				</div>
				{% else %}
					Alarm Not Active
					{% if current_user.is_alarm_setter() %}
					<a	class="btn btn-primary" role="button" 
						href="{{ url_for('monitor.activate_config') }}"
						onclick="return window.confirm('Are you sure you want to activate the alarm system?');">
						Activate
					</a>
					{% endif %}
				</h3>
				{% endif %}
				{# TODO show events history #}
			{% else %}
				<h3>No current configuration created yet!</h3>
			{% endif %}
			</div>
		</div>
	</div>
{% endblock %}
